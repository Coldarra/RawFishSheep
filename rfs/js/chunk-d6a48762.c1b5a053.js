(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d6a48762"],{"2e53":function(t,e,s){},"44e1":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"search"}},[s("el-container",[s("el-container",{staticStyle:{border:"1px solid #eee",width:"77%"}},[s("el-aside",{staticStyle:{"border-right":"green",width:"15%"}},[s("el-card",{staticStyle:{height:"100%",background:"#f3f3f3"},attrs:{"body-style":{padding:"0px",height:"100%"}}},[s("div",{staticClass:"vertical-center"},[t._v("筛选：")])])],1),s("el-container",[s("el-main",[s("div",{staticClass:"line",staticStyle:{margin:"0% 18%"}},t._l(t.category,function(e,o){return s("div",{key:o},[s("el-radio-group",{model:{value:t.radio[o],callback:function(e){t.$set(t.radio,o,e)},expression:"radio[id]"}},t._l(e,function(e,o){return s("el-radio-button",{key:o,attrs:{label:e.label},nativeOn:{click:function(s){return s.preventDefault(),t.showChildCategory(e.children,e.level,e.label)}}})}),1)],1)}),0)]),s("el-aside",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[s("div",{staticClass:"vertical-center"},[s("div",[s("el-link",{staticStyle:{"font-size":"30px"},attrs:{icon:"el-icon-s-grid",underline:!1},on:{click:function(e){return t.changeShow("1")}}}),s("el-link",{staticStyle:{"font-size":"30px"},attrs:{icon:"el-icon-s-unfold",underline:!1},on:{click:function(e){return t.changeShow("2")}}})],1)])])],1)],1),s("el-container",{directives:[{name:"show",rawName:"v-show",value:t.searchAlert,expression:"searchAlert"}],staticStyle:{margin:"20px"}},[s("div",[s("el-alert",{attrs:{title:"提示",type:"error",description:"抱歉，没有符合筛选条件的商品",effect:"dark","show-icon":""}})],1)]),s("el-main",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticStyle:{width:"80%"},attrs:{id:"gridShow"}},t._l(t.row,function(e){return s("el-row",{key:e,staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},t._l(t.gridGoods[e],function(e,o){return s("el-col",{key:o,attrs:{span:6}},[s("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[s("img",{staticClass:"image",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.picture_url}}),s("div",{staticStyle:{padding:"14px"}},[s("div",{staticStyle:{"text-align":"left",color:"#e4393c"}},[t._v("¥ "+t._s(e.price)+" / "+t._s(e.unit))]),s("div",{staticStyle:{"text-align":"left"}},[s("el-link",{attrs:{underline:!1}},[t._v(t._s(e.name))])],1),s("div",{staticStyle:{"text-align":"left"}},[s("el-tag",{attrs:{type:t.tags[e.category]}},[t._v(t._s(e.category))])],1),s("div",{staticStyle:{"text-align":"left"}},[t._v("库存 ："+t._s(e.remain)+t._s(e.unit))]),s("div",[s("el-button",{attrs:{type:"text",icon:"el-icon-shopping-cart-full"},on:{click:function(s){return t.Public.addToCartList(e.goods_id)}}},[t._v("加入购物车")])],1)])])],1)}),1)}),1),s("el-main",{directives:[{name:"show",rawName:"v-show",value:!t.visible,expression:"!visible"}],staticStyle:{width:"80%"},attrs:{id:"listShow"}},t._l(t.listGoods,function(e,o){return s("el-card",{key:o,staticStyle:{"margin-bottom":"10px"},attrs:{"body-style":{padding:"0px",height:"50%"},shadow:"hover"}},[s("div",[s("div",{staticStyle:{display:"inline"}},[s("img",{staticClass:"image",staticStyle:{width:"10rem",height:"10rem"},attrs:{src:e.picture_url}})]),s("div",{staticStyle:{display:"inline-block"}},[s("div",{staticStyle:{"text-align":"left"}},[s("el-link",{attrs:{underline:!1}},[t._v(t._s(e.name))])],1),s("el-rate",{staticStyle:{"text-align":"center"},attrs:{disabled:"","show-score":""},model:{value:t.rates,callback:function(e){t.rates=e},expression:"rates"}}),s("div",{staticStyle:{"text-align":"left",color:"#e4393c"}},[t._v("¥ "+t._s(e.price))]),s("div",{staticStyle:{"text-align":"left"}},[s("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e.category))])],1),s("div",{staticStyle:{"text-align":"left"}},[s("div",{staticStyle:{"text-align":"left"}},[t._v("库存 ："+t._s(e.remain)+t._s(e.unit))])]),s("div",{staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"text",icon:"el-icon-shopping-cart-full"}},[t._v("加入购物车")])],1)],1)])])}),1),s("el-footer",[s("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next, jumper",total:t.searchResultLength,"hide-on-single-page":!1},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)],1)],1)},a=[],i=(s("7f7f"),{name:"search",data:function(){return{allGoods:[],totalGoods:[],goods:[],listGoods:[],gridGoods:[],category:[],row:[],tags:{"蔬菜":"success","水果":"info","海鲜":"warning","肉类":"danger","熟食":"","其他":""},allCategory:{},filterCategory:[],searchResultLength:0,pageSize:8,visible:!0,searchAlert:!1,rates:3.3,currentPage:1,radio:[],reg:this.$store.state.searchRegExp}},created:function(){var t=this;this.getsearchResultLength(),void 0==this.$store.state.category?this.Public.getCategory().then(function(e){console.log("F SUCCESS",e),t.getCategory(e)}).catch(function(t){console.log("F ERROR",t)}):this.getCategory(this.$store.state.category)},methods:{handleCurrentChange:function(t){console.log("当前页: ".concat(t)),this.currentPage=t,this.changePages(t)},changeShow:function(t){return!0},getsearchResultLength:function(){var t=this;this.$ajax.post("/api/goods/all",{}).then(function(e){"0"==e.data.ret&&(t.allGoods=e.data.data.goods,t.totalGoods=e.data.data.goods,t.goods=e.data.data.goods,t.searchResultLength=t.goods.length,console.log("goods/all",e),t.handleCurrentChange(1))}).catch(function(t){console.log(t)})},changePages:function(t){var e=this.goods,s=this.pageSize;0!==this.row.length&&(this.row=[]);var o=e.length-s*(t-1);o>s&&(o=s);for(var a=0;a<Math.ceil(o/4);a++)this.row.push(a);this.listGoods=[],this.gridGoods=[];for(var i=s*(t-1),r=1,n=0;n<this.row.length;n++){for(var l=[],c=0;c<4&&i<e.length&&r<=s;c++){if(i>=e.length)break;this.listGoods.push(e[i]),l.push(e[i++]),r++}this.gridGoods.push(l)}},getCategory:function(t){this.category=[],this.category.push(t),this.getCategoryTree(t),console.log("SEARCH.VUE, GETCATEGORY",this.category)},getCategoryTree:function(t){var e={};function s(t,o){for(var a=0;a<t.length;a++)e[t[a].label]=o,"children"in t[a]&&s(t[a].children,t[a].label)}s(t,"top"),this.allCategory=e,console.log("allcategory:",this.allCategory)},showChildCategory:function(t,e,s){while(this.category.length>e)this.category.pop();var o=this.allCategory,a=(this.category,[]);function i(t){"top"!=o[t]&&i(o[t]),a.push(t)}i(s),this.radio=a;var r=[];r.push(s),r=c(t,r),this.filterCategory=r;var n=this.totalGoods;this.goods=[];for(var l=0;l<n.length;l++)r.indexOf(n[l].category)>-1&&this.goods.push(n[l]);function c(t,e){if(void 0===t)return e;for(var s=0;s<t.length;s++)e.push(t[s].label),"children"in t[s]&&c(t[s].children,e);return e}this.$forceUpdate(),this.changePages(this.currentPage),this.searchAlert=0===this.goods.length,this.searchResultLength=this.goods.length,void 0!==t&&this.category.push(t)}},mounted:function(){var t=this;setTimeout(function(){console.log("category: ",t.$route.query.category);for(var e=t.$route.query.category,s=t.category[0],o=0;o<s.length;o++)if(s[o].label===e){console.log("T{I}",s[o]),t.showChildCategory(s[o].children,s[o].level,s[o].label);break}},150)},watch:{"$route.query.category":function(t,e){console.log("category: ",this.$route.query.category);for(var s=this.$route.query.category,o=this.category[0],a=0;a<o.length;a++)if(o[a].label===s){console.log("T{I}",o[a]),this.showChildCategory(o[a].children,o[a].level,o[a].label);break}},"$route.query.content":function(t,e){console.log("searchbox: ",this.$route.query.content);var s=this.$store.state.searchRegExp,o=this.allGoods;this.goods=[];for(var a=0;a<o.length;a++)s.test(o[a].name)&&this.goods.push(o[a]);console.log("REG goods",this.goods),this.totalGoods=this.goods,this.$forceUpdate(),this.changePages(this.currentPage),this.searchAlert=0===this.goods.length,this.searchResultLength=this.goods.length,this.category=[],this.category.push(this.$store.state.category)},"$store.state.searchbox":function(t,e){console.log("searchbox: ",this.$store.state.searchbox);var s=this.$store.state.searchRegExp,o=this.allGoods;this.goods=[];for(var a=0;a<o.length;a++)s.test(o[a].name)&&this.goods.push(o[a]);console.log("REG goods",this.goods),this.totalGoods=this.goods,this.$forceUpdate(),this.changePages(this.currentPage),this.searchAlert=0===this.goods.length,this.searchResultLength=this.goods.length,this.category=[],this.category.push(this.$store.state.category)}}}),r=i,n=(s("9c0e"),s("2877")),l=Object(n["a"])(r,o,a,!1,null,"7f013147",null);e["default"]=l.exports},"9c0e":function(t,e,s){"use strict";var o=s("2e53"),a=s.n(o);a.a}}]);
//# sourceMappingURL=chunk-d6a48762.c1b5a053.js.map